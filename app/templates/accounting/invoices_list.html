{% extends "base_accounting.html" %}
{% block acct_content %}
<div class="flex items-center justify-between mb-6">
  <h2 class="text-2xl font-bold text-blue-900">{{ _('Invoices') }}</h2>
  <a href="{{ url_for('acct.invoices_new') }}"
     class="px-4 py-2 bg-blue-600 text-white font-medium rounded-lg shadow hover:bg-blue-700 transition">
     + {{ _('New Invoice') }}
  </a>
</div>

<div class="overflow-x-auto bg-white border border-gray-200 rounded-2xl shadow-sm">
  <table class="min-w-full text-sm text-gray-700">
    <thead class="bg-blue-50 text-blue-900 font-semibold">
      <tr>
        <th class="px-4 py-3 text-left">{{ _('Invoice No') }}</th>
        <th class="px-4 py-3 text-left">{{ _('Client') }}</th>
        <th class="px-4 py-3 text-left">{{ _('Total (OMR)') }}</th>
        <th class="px-4 py-3 text-left">{{ _('Status') }}</th>
        <th class="px-4 py-3 text-left">{{ _('Date') }}</th>
        <th class="px-4 py-3 text-left">{{ _('Actions') }}</th>
      </tr>
    </thead>

    <tbody>
      {% for inv in invoices %}
      <tr class="border-t border-gray-100 hover:bg-blue-50 transition">
        <td class="px-4 py-3 font-medium text-gray-800">{{ inv.invoice_number }}</td>
        <td class="px-4 py-3">{{ inv.customer.display_name if inv.customer else '-' }}</td>
        <td class="px-4 py-3 text-gray-700">{{ '%.3f'|format(inv.total_omr or 0) }}</td>
        <td class="px-4 py-3">
          <span class="
            px-2 py-1 rounded-full text-xs font-medium
            {% if inv.status == 'Paid' %} bg-green-100 text-green-700
            {% elif inv.status == 'Partial' %} bg-yellow-100 text-yellow-700
            {% elif inv.status == 'Cancelled' %} bg-red-100 text-red-700
            {% else %} bg-gray-100 text-gray-700 {% endif %}
          ">
            {{ inv.status }}
          </span>
        </td>
        <td class="px-4 py-3">{{ inv.created_at.strftime('%Y-%m-%d') }}</td>
        <td class="px-4 py-3 flex items-center gap-3">
          <a href="{{ url_for('acct.invoices_edit', invoice_id=inv.id) }}"
             class="text-blue-600 hover:underline">{{ _('Edit') }}</a>
          <a href="{{ url_for('acct.invoices_export', invoice_id=inv.id) }}"
             class="text-blue-600 hover:underline">PDF</a>
          <form method="post"
                action="{{ url_for('acct.invoices_delete', invoice_id=inv.id) }}"
                class="inline"
                onsubmit="return confirm('{{ _('Delete invoice?') }}')">
            <button class="text-red-500 hover:underline">{{ _('Delete') }}</button>
          </form>
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="6" class="px-4 py-6 text-center text-gray-400">{{ _('No invoices.') }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
