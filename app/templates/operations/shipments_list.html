{% extends "layout.html" %}
{% block title %}{{ _('Shipments') }}{% endblock %}
{% block content %}
<div class="max-w-7xl mx-auto">
  <!-- العنوان وأزرار التحكم -->
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-bold text-blue-900">{{ _('Shipments') }}</h1>
    <a href="{{ url_for('ops.shipments_new') }}" 
       class="px-4 py-2 bg-blue-700 hover:bg-blue-800 text-white rounded-lg shadow transition">
      {{ _('Create Shipment') }}
    </a>
  </div>

  <!-- جدول الشحنات -->
  <div class="bg-white border border-slate-200 rounded-2xl shadow-sm overflow-hidden">
    <table class="min-w-full text-sm text-slate-700">
      <thead class="bg-blue-50 text-blue-900 border-b border-slate-200">
        <tr>
          <th class="py-3 px-4 text-left font-semibold">{{ _('Shipment No') }}</th>
          <th class="py-3 px-4 text-left font-semibold">{{ _('Type') }}</th>
          <th class="py-3 px-4 text-left font-semibold">{{ _('Port From') }}</th>
          <th class="py-3 px-4 text-left font-semibold">{{ _('Port To') }}</th>
          <th class="py-3 px-4 text-left font-semibold">{{ _('Departure') }}</th>
          <th class="py-3 px-4 text-left font-semibold">{{ _('Status') }}</th>
          <th class="py-3 px-4 text-left font-semibold">{{ _('Cars') }}</th>
          <th class="py-3 px-4 text-left font-semibold text-center">{{ _('Actions') }}</th>
        </tr>
      </thead>
      <tbody>
        {% for s in shipments %}
        <tr class="hover:bg-blue-50 transition border-b">
          <td class="py-3 px-4 font-medium text-blue-800">{{ s.shipment_number }}</td>
          <td class="py-3 px-4">{{ s.type }}</td>
          <td class="py-3 px-4">{{ s.origin_port }}</td>
          <td class="py-3 px-4">{{ s.destination_port }}</td>
          <td class="py-3 px-4">{{ s.departure_date.strftime('%Y-%m-%d') if s.departure_date else '-' }}</td>
          <td class="py-3 px-4">
            {% if s.status == 'Open' %}
              <span class="px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-700">{{ s.status }}</span>
            {% elif s.status == 'In Transit' %}
              <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-700">{{ s.status }}</span>
            {% elif s.status == 'Arrived' %}
              <span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-700">{{ s.status }}</span>
            {% elif s.status == 'Delivered' %}
              <span class="px-2 py-1 text-xs rounded-full bg-indigo-100 text-indigo-700">{{ s.status }}</span>
            {% endif %}
          </td>
          <td class="py-3 px-4">{{ cars_count.get(s.id, 0) }}</td>
          <td class="py-3 px-4 text-center">
            <a href="{{ url_for('ops.shipments_edit', shipment_id=s.id) }}" 
               class="text-blue-700 hover:underline">{{ _('Edit') }}</a>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="8" class="py-6 text-center text-gray-500">{{ _('No shipments found.') }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- رابط التصدير -->
  <div class="mt-4 text-right">
    <a href="{{ url_for('ops.shipments_export') }}" 
       class="text-sm text-blue-700 hover:underline">
      {{ _('Export CSV') }}
    </a>
  </div>
</div>
{% endblock %}
